<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:OrbisDbTools.Avalonia.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="920" d:DesignHeight="600"
        MinWidth="920" MinHeight="600"
        MaxWidth="920" MaxHeight="600"
        WindowStartupLocation="CenterScreen"
        x:Class="OrbisDbTools.Avalonia.Views.MainWindow"
        Icon="/Assets/avalonia-logo.ico"
        Title="OrbisDbTools.Avalonia">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Grid>
        <Image Source="/Assets/GamingBackground.png" />

        <Grid IsVisible="{Binding !DbConnected}" Name="PsConnection" HorizontalAlignment="Center" >
            <TextBlock 
                Margin="100" Text="Connect to your system" 
                FontSize="48" FontFamily="SF Pro Display" VerticalAlignment="Top"/>

            <TextBlock 
                Text="Please enable FTP server on your PlayStationÂ®4, then enter IP address of your console below." 
                FontSize="16" FontFamily="SF Pro Display" VerticalAlignment="Center" TabIndex="0"
                MaxWidth="350" TextWrapping="Wrap" TextAlignment="Center" Margin="0, 0, 0, 60"/>

            <TextBox 
                FontSize="16" FontFamily="SF Pro Display" Height="40" Width="300" 
                VerticalAlignment="Center" Margin="0, 80, 0, 0" Watermark="192.168.[*].[*]:2121"
                Text="{Binding ConsoleIpAddress}"/>

            <Button
                VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="0, 0, 0, 100" 
                Content="CONNECT" Foreground="#bb86fc" FontFamily="SF Pro Display" FontSize="20"
                Command="{Binding ConnectDb}" TabIndex="1"/>
            
            <TextBlock
                 FontFamily="SF Pro Display" FontSize="16" Text="{Binding ConnectionError}"
                 VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="0, 0, 0, 170" Foreground="Pink" />
        </Grid>

        <StackPanel IsVisible="{Binding DbConnected}" Name="AppDbActions" Orientation="Vertical" VerticalAlignment="Center" Margin="15">
            <Button IsEnabled="{Binding !ShowProgressBar}" Command="{Binding RecalculateDbContent}">Recalculate content size</Button>
            <Button IsEnabled="{Binding !ShowProgressBar}" Command="{Binding AllowDeleteApps}">Allow delete installed content</Button>
            <Button IsEnabled="{Binding !ShowProgressBar}" Command="{Binding HidePsnApps}">Hide PSN Apps</Button>
            <Button IsEnabled="{Binding !ShowProgressBar}" Command="{Binding ForceDc}">Close Database</Button>
        </StackPanel>

        <Grid VerticalAlignment="Center" HorizontalAlignment="Center" IsVisible="{Binding ShowProgressBar}">
            <Rectangle Fill="Black" Opacity="0.9" Width="600" Height="150" />
            <StackPanel VerticalAlignment="Center" Orientation="Vertical">
                <TextBlock Margin="15" TextAlignment="Center" FontFamily="SF Pro Display" FontSize="18" Text="{Binding ProgressText}" />
                <ProgressBar Margin="15" IsIndeterminate="True"/>
            </StackPanel>
        </Grid>
    </Grid>

</Window>
